# Aircraft Identification Mixture of Experts (MoE) ML Model

## Authors: Johannes von Streuselberg and Grok

The goal of this repo is to demonstrate how to train a machine learning model and open source the weights generated by training on the 
Fine Grained Visual Classification Aircraft (herein FGVCA or FGVA) Dataset.

# Dataset

You can find the dataset here on [kaggle](https://www.kaggle.com/datasets/seryouxblaster764/fgvc-aircraft)

# The Model

This model is a mixture of experts model

# Getting Started 

NOTE: We will assume you are at the root of the repository for all commands referenced below.

## Setup
This assumes that you have python3 installed and a CUDA capable machine. It will still work if you do not have a device
capable of using the CUDA libraries, however it will use CPU and therefore be much more time intensive.

a. download the dataset (see [Where to find the dataset](#Dataset))
b. download dependencies `pip install -r requirements.txt`
c. point data_base_dir to the root of the FGVC-Aircraft data set

## Training

a. Run training. `py train.py`

the script will output the result of the epochs. It can take some time for the first result to display, depending on the hardware you're
using. It defaults to 20 epochs (training runs/batches) but you can continue training for as long as you find the accuracies are increasing
at an order you find suitable. 

## Export (to ONNX)

This can be achieved one of two ways with these scripts. You can either set the `FULLY_BAKED = True` in `training.py` 
or simply run `export.py` to have the model exported to the ONNX format.

a. Run export `py export.py`

## Inference

f. Run inference `py inference.py path/to/img` 

### To The Curious

Yes, this was mostly vibe-coded with grok; however, the state of this repo is after significant de-duplication and refactoring to produce
a suite of scripts that would allow one to serve inferences about the family, manufacturer, and variant of a given aircraft in an image.

# License

Software is provided under the MIT License, see LICENSE file for more information.

Thanks!
